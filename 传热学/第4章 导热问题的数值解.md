# 第一节 导热问题数值解概述

**分析解法的优点**：求解过程中的数学分析较严谨；求解结果以函数形式表示，能清楚地显示各种因素对温度分布的影响。但是，工程技术中遇到的许多导热问题具有**复杂的形状或边界条件**，无法得出其分析解。

**数值计算方法**：有效解决复杂问题的方法；是具有一定精度的近似方法，但精度比较粗糙。

数值求解通常是把微分方程转化为一组代数方程组再求解。

如何实现从微分方程到代数方程的转化？
$$
数值解法
\begin{cases}
有限差分法(finite-difference)\\
有限元法(finite-element)\\
边界元法(boundary-element)\\
分子动力学模拟(MD)
\end{cases}
$$

# 第二节 建立离散方程的方法

## 一、有限差分法

有限差分法的基本思想是：把原来在时间和空间坐标中连续变化的物理量（如温度、压力、速度和热流等），用有限个离散点上的数值集合来近似表示。

有限差分的数学基础是：用**差商**代替微商（导数）

几何意义是：用函数在某区域内的**平均变化率**代替函数的真实变化率

向后差分格式：
$$
\frac{dT_i}{dx}\approx\frac{T(x_i)-T(x_i-\Delta x)}{\Delta x}
$$
向前差分格式：
$$
\frac{dT_i}{dx}\approx\frac{T(x_i+\Delta x)-T(x_i)}{\Delta x}
$$
中心差分格式：
$$
\frac{dT_i}{dx}\approx\frac{T(x_i+\Delta x)-T(x_i-\Delta x)}{\Delta x}
$$
对于二阶微商的差分格式：
$$
\frac{d^2T_i}{dx^2}\approx\frac{T(x_i+\Delta x)-2T(x_i)+T(x_i-\Delta x)}{(\Delta x)^2}
$$
采用这样的处理之后，反映温度场随时间、空间连续变化的微分方程就可以用反映离散点间温度线性变化规律的代数方程来表示。

当利用相应的数学办法求解这些代数方程组之后，我们就能获得离散点上的温度值。这些温度值就可以近似表示温度场的连续的温度分布。

导热问题进行数值求解时要采取三个步骤，即：

* 研究区域的离散化；
* 离散点（节点）差分方程的建立；
* 节点方程（代数方程）的求解。

具体方法：设为二维导热问题

1. 划网格

   沿x、y方向的间距为 $\Delta x、\Delta y$ 网格线；网格单元节点：网格线的交点

   | 内部节点 | 外界节点 |
   | :------: | :------: |
   |   20个   |   22个   |

   关于网格的说明：

   * 可以是矩形，也可以是▲或梯形等（根据需要）
   * 可以均匀，也可不均匀（边界处、温度梯度大处）
   * 最简单的是均匀的正方形（即 $\Delta x=\Delta y$)
   * 自适应网格——根据计算结果，按程序自动调整
   * 每个节点温度就代表了它所在网格单元的温度
   * 此方法求得的温度场在空间上不连续
   * 网格越细密、节点越多，结果越接近分析解，计算所花时间越长

   对于非稳态导热：

   除了在空间上把物体分割成网格单元，时间上也要分割成许多间隔 $\Delta\tau$

2. 编码

   * 单码：一维数组
   * 双码：二维数组

## 二、建立差分方程的方法

1. Taylor（泰勒）级数展开法

   将函数 $t(x,y,z)$ 在某点 $(i+1,j)$ 对点 $(i,j)$ 作泰勒展开

2. 热平衡法

   稳态导热： $导入与导出网格单元净热量+网格单元内热源发热量=0$

   不存在内热源时： $\Phi_{WP}+\Phi_{EP}+\Phi_{NP}+\Phi_{SP}=0$

#### 边界节点温度差分方程

第一类边界条件：问题简单；边界节点温度给定

第二类、第三类边界条件：根据给定的具体条件，针对边界节点所在的网格单元，写出热平衡关系式，建立边界节点温度离散方程

写出所有内节点和边界节点的温度差分方程

n个未知节点温度，n个线性方程式

线性方程组的求解方法：直接解法（矩阵求逆，高斯消元法）、迭代解法（简单迭代、高斯赛德耳迭代、块迭代）

判断迭代是否收敛的准则：
$$
\max\abs{t_i^{k+1}-t_i^{k}}\leq\varepsilon
$$
