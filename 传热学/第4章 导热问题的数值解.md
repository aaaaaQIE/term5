# 第一节 导热问题数值解概述

**分析解法的优点**：求解过程中的数学分析较严谨；求解结果以函数形式表示，能清楚地显示各种因素对温度分布的影响。但是，工程技术中遇到的许多导热问题具有**复杂的形状或边界条件**，无法得出其分析解。

**数值计算方法**：有效解决复杂问题的方法；是具有一定精度的近似方法，但精度比较粗糙。

数值求解通常是把微分方程转化为一组代数方程组再求解。

如何实现从微分方程到代数方程的转化？
$$
数值解法
\begin{cases}
有限差分法(\mathrm{finite-difference})\\
有限元法(\mathrm{finite-element})\\
边界元法(\mathrm{boundary-element})\\
分子动力学模拟(\mathrm{MD})
\end{cases}
$$

# 第二节 建立离散方程的方法

## 一、有限差分法

有限差分法的基本思想是：把原来在时间和空间坐标中连续变化的物理量（如温度、压力、速度和热流等），用有限个离散点上的数值集合来近似表示。

有限差分的数学基础是：用**差商**代替微商（导数）

几何意义是：用函数在某区域内的**平均变化率**代替函数的真实变化率

向后差分格式：
$$
\frac{dT_i}{dx}\approx\frac{T(x_i)-T(x_i-\Delta x)}{\Delta x}
$$
向前差分格式：
$$
\frac{dT_i}{dx}\approx\frac{T(x_i+\Delta x)-T(x_i)}{\Delta x}
$$
中心差分格式：
$$
\frac{dT_i}{dx}\approx\frac{T(x_i+\Delta x)-T(x_i-\Delta x)}{\Delta x}
$$
对于二阶微商的差分格式：
$$
\frac{d^2T_i}{dx^2}\approx\frac{T(x_i+\Delta x)-2T(x_i)+T(x_i-\Delta x)}{(\Delta x)^2}
$$
采用这样的处理之后，反映温度场随时间、空间连续变化的微分方程就可以用反映离散点间温度线性变化规律的代数方程来表示。

当利用相应的数学办法求解这些代数方程组之后，我们就能获得离散点上的温度值。这些温度值就可以近似表示温度场的连续的温度分布。

导热问题进行数值求解时要采取三个步骤，即：

* 研究区域的离散化；
* 离散点（节点）差分方程的建立；
* 节点方程（代数方程）的求解。

具体方法：设为二维导热问题

1. 划网格

   沿x、y方向的间距为 $\Delta x、\Delta y$ 网格线；网格单元；节点：网格线的交点

   | 内部节点 | 外界节点 |
   | :------: | :------: |
   |   20个   |   22个   |

   关于网格的说明：

   * 可以是矩形，也可以是▲或梯形等（根据需要）
   * 可以均匀，也可不均匀（边界处、温度梯度大处）
   * 最简单的是均匀的正方形（即 $\Delta x=\Delta y$)
   * 自适应网格——根据计算结果，按程序自动调整
   * 每个节点温度就代表了它所在网格单元的温度
   * 此方法求得的温度场在空间上不连续
   * 网格越细密、节点越多，结果越接近分析解，计算所花时间越长

   对于非稳态导热：

   除了在空间上把物体分割成网格单元，时间上也要分割成许多间隔 $\Delta\tau$

2. 编码

   * 单码：一维数组
   * 双码：二维数组

## 二、建立差分方程的方法

1. Taylor（泰勒）级数展开法

   将函数 $t(x,y,z)$ 在某点 $(i+1,j)$ 对点 $(i,j)$ 作泰勒展开

2. 热平衡法

   稳态导热： $导入与导出网格单元净热量+网格单元内热源发热量=0$

   不存在内热源时： $\Phi_{WP}+\Phi_{EP}+\Phi_{NP}+\Phi_{SP}=0$
   
3. 多项式拟合法

4. 控制容积积分法

#### 边界节点温度差分方程

第一类边界条件：问题简单；边界节点温度给定

第二类、第三类边界条件：根据给定的具体条件，针对边界节点所在的网格单元，写出热平衡关系式，建立边界节点温度离散方程

写出所有内节点和边界节点的温度差分方程

n个未知节点温度，n个线性方程式

线性方程组的求解方法：直接解法（矩阵求逆，高斯消元法）、迭代解法（简单迭代、高斯赛德耳迭代、块迭代）

#### 节点方程式的求解

写出所有内节点和边界节点的温度差分方程

n个为止节点温度，n个方程

判断迭代是否收敛的准则：
$$
\max\abs{t_i^{k+1}-t_i^{k}}\leq\varepsilon
$$
相对偏差值一般取： $10^{-3}\sim10^{-6}$

# 第四节 非稳态导热问题的数值计算

非稳态导热与稳态导热的主要区别：温度随空间和时间变化；控制方程中多一个非稳态项。

能量平衡关系：网格单元不仅与相邻的网格单元之间

#### 内部节点的显式差分格式

网格傅立叶数： $Fo=\frac{a\Delta\tau}{\Delta x^2}$ 
$$
t_i^{k+1}=Fo_\Delta(t_{i-1}^k+t_{i+1}^k)+(1-2Fo_\Delta)t_i^k
$$
$(k+1)\Delta\tau$ 时刻各节点的温度直接利用前一个时刻 $(k\Delta\tau)$ 各节点的温度以显函数的形式表示。

根据稳定性分析：必须保证每项外面的系数 $\geq0$

一维非稳态内节点显式差分格式的稳定性条件：
$$
1-2Fo_\Delta\geq0\Rightarrow Fo_\Delta=\frac{a\Delta\tau}{\Delta x^2}\leq\frac12
$$

#### 内部节点的隐式差分格式

$$
(1+2Fo)t_i^{k+1}=Fo(t_{i-1}^{k+1}+t_{i+1}^{k+1})+t_i^k
$$

隐差分格式无条件收敛， $\Delta x和\Delta\tau$的选取是任意的。

#### 边界节点温度差分方程

网格毕渥数： $Bi_\Delta=\frac{h\Delta x}{\lambda}$
$$
t_0^{k+1}=2Fo_\Delta(t_1^k+Bi_\Delta t_f^k)+(1-2Fo_\Delta-2Fo_\Delta Bi_\Delta)t_0^k
$$
稳定性条件：
$$
1-2Fo_\Delta-2Fo_\Delta Bi_\Delta\geq0\\
Fo_\Delta\leq\frac1{2Bi_\Delta+2}
$$
一维、非稳态导热，综合考虑内节点与边界节点，应用显式差分格式的稳定性条件：

第三类边界条件：
$$
Fo_\Delta\leq\frac12\\
Fo_\Delta\leq\frac1{2Bi_\Delta+2}
$$
第一、二类边界条件：
$$
Fo_\Delta\leq\frac12
$$

#### 节点方程组的求解

所有内节点差分方程+边界节点差分方程

显式差分格式时，直接求解；

隐式差分格式时，迭代法求解。

##### 1）应用显式差分格式时：

计算简单；根据初始条件可以此计算出各个时刻、各节点的温度值

##### 2）应用隐式差分格式时：

需采用迭代差分法

# 导热部分小节

导热微分方程式+单值性条件+求解方法=温度场

导热微分方程式：热力学第一定律，傅里叶定律

单值性条件：几何条件，物理条件，初始条件，边界条件（一二三）

求解方法：分析解法（分离变量法），近似解法（集总参数法），数值解法（有限差分法）
$$
导热
\begin{cases}
	稳态导热(一维)
		\begin{cases}
		大平壁_{Q,\Phi,q均为常数}\\
		长圆筒_{Q,\Phi为常数，q为变量}\\
		肋片_{Q,\Phi,q均为变量，仅考虑肋基处的这些量}
		\end{cases}\\
	非稳态导热
		\begin{cases}
		瞬态\\
		周期性
		\end{cases}\\
	导热的数值解法
\end{cases}
$$

#### 稳态导热

* 基本概念：温度场、等温面（线）、温度梯度、热流密度矢量、稳态导热、非稳态导热等。
* 导热系数，反映物体的导热能力，影响因素，典型工程材料导热系数的数值。
* 热扩散率，表征非稳态导热过程中物体内部各处温度趋向均匀一致的能力。
* 管道临界绝缘直径 $d_c=2\lambda_{ins}/h_2$ 、接触热阻（组成与因素）
* 傅里叶定律，适用于连续均匀各向同性材料的稳态和非稳态导热过程。
* 导热微分方程（通用方程）
* 单值性条件包括几何、物理、初始和三类边界条件。
* 应用公式或图线计算肋片的温度分布、肋片效率和通过肋片的散热量。

#### 非稳态导热

* 瞬态导热与周期性导热过程的特点。
*  $Bi$ 和 $Fo$ 准则的意义
* 弛豫时间、渗透厚度（常热流密度条件下半无限大物体内，界面上热作用的影响所波及的厚度， $\delta(\tau)=\sqrt{12a\tau}$ 的意义
* 集总参数法分析非稳态导热过程

#### 导热的数值解

* 区域和时间的离散化
* 基于泰勒级数法和热平衡法建立内节点与边界节点温度的离散方程。
* 基于有限差分的数值解法，利用差商代替导数。有限差分表达式有中心差分、向前差分和向后差分三种。
* 一般温度对空间坐标的二阶导数采用中心差分表达式、温度对时间的一阶导数采用向前差分或向后差分表达式，建立的瞬态导热离散方程有显式差分格式和隐式差分格式。
* 稳态导热节点离散方程可表示成 $[A][t]=[c]$ ，采用高斯——赛德尔迭代求解。
* 非稳态导热的显式离散方程可直接求解，但受稳定性条件的限制，时间和网格步长选取不任意；隐式离散方程需联立迭代求解，无条件稳定。
